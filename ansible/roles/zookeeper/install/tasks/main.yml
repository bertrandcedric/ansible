---
- name: Check install zookeeper
  stat: path="/opt/zookeeper-3.4.8"
  register: st
  become: yes

- name: Install zookeeper
  unarchive:
    src: "zookeeper-3.4.8.tar.gz"
    dest: "/opt"
  become: yes
  when: not st.stat.exists

- name: Create symlink /opt/zookeeper
  file:
    src: "/opt/zookeeper-3.4.8"
    dest: "/opt/zookeeper"
    state: link
  become: yes

- name: Adding the path in the bashrc files
  lineinfile:
    dest: "/home/deploy/.bashrc"
    line: 'export PATH=$PATH:/opt/zookeeper/bin'
    insertafter: 'EOF'
    regexp: 'export PATH=\$PATH:/opt/zookeeper/bin'
    state: present
