---
# Gather facts to be able to use them in next plays
- hosts: all
  gather_facts: yes
  remote_user: deploy

- hosts: all
  gather_facts: no
  remote_user: deploy
  roles:
#    - { role: test }
    - { role: mongodb/commons }

- hosts: replica
  gather_facts: no
  remote_user: deploy
  tags: [server]
  roles:
    - { role: mongodb/replica }

- hosts: client
  gather_facts: no
  remote_user: deploy
  tags: [client]
  roles:
    - { role: mongodb/client }

# Creation de la config apres avoir creer le replica #
- hosts: config
  gather_facts: no
  remote_user: deploy
  tags: [server]
  roles:
    - { role: mongodb/config }

- hosts: shard
  gather_facts: no
  remote_user: deploy
  tags: [server]
  roles:
    - { role: mongodb/shard }

